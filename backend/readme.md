# QuietGrove Backend API 🏡

API для бронирования загородных домов с управлением домами, дополнительными услугами и бронированиями.

## Основные возможности

* Управление каталогом домов, бань и дополнительных услуг
* Поиск доступных домов по датам
* Подтверждение личности гостя через Telegram‑бот (6‑значный код)
* Уведомления администратору о новых бронированиях и заявках в Telegram
* Автоматические уведомления гостей о подтверждении бронирования
* Бронирование c учётом гостей и услуг
* Приём заявок на проведение мероприятий

---

## Эндпоинты

### Общие

* `GET /health` — Проверка работоспособности сервиса
* `GET /version` — Получение версии приложения

### Дома

* `GET /houses` — Получить все дома
* `POST /houses` — Добавить новый дом
* `PUT /houses/{id}` — Обновить дом по ID
* `DELETE /houses/{id}` — Удалить дом по ID

### Бани

* `GET /bathhouses` — Получить все бани
* `POST /bathhouses` — Добавить новую баню
* `PUT /bathhouses/{id}` — Обновить баню по ID
* `DELETE /bathhouses/{id}` — Удалить баню по ID

### Дополнительные услуги

* `GET /extras` — Получить все доп. услуги
* `POST /extras` — Добавить новую услугу
* `PUT /extras/{id}` — Обновить услугу по ID
* `DELETE /extras/{id}` — Удалить услугу по ID

### Бронирования

* `GET /reservation` — Поиск доступных домов. Доступные query-параметры: 
    - `guests` - Количество гостей
    - `in` - Дата заезда (YYYY-MM-DD)
    - `out` - Дата выезда (YYYY-MM-DD)

* `POST /reservation` — Создать новое бронирование

### Мероприятия

* `POST /events` — Создать новую заявку на проведение мероприятия

### Подтверждение личности

| Шаг | Действие                                                                                                       |
| --- | -------------------------------------------------------------------------------------------------------------- |
| 1   | `POST /verification` — передайте `email`, `name` и `phone`, получите 6‑значный `code`                          |
| 2   | Гость открывает Telegram‑бота `@QuiteGrove_bot` и отправляет полученный код                                    |
| 3   | После успешной проверки бот отвечает «✅ Личность подтверждена!» и система привязывает Telegram‑аккаунт к гостю |

---

## Telegram‑уведомления

### Администратор

**Новое бронирование**

```
✅ Новое бронирование
🏠 Дом: Барнхаус
👤 Гость: Анна Иванова
📞 +79001234567
📅 12.08.2025 → 15.08.2025
👥 4 гостя
💳 37 000 ₽
```

**Новая заявка на мероприятие**

```
🎉 Новая заявка на мероприятие!
👤 Имя: Анна Иванова
📞 Телефон: +79001234567
📅 Дата: 2025‑07‑05
👥 Кол‑во гостей: 5
```

### Гость

Сообщение после подтверждения бронирования:

```
✅ Ваше бронирование подтверждено!
🏠 Дом: Барнхаус
📅 05.07.2025 → 10.07.2025
👥 7 гостей
💳 Стоимость проживания: 75 000 ₽
📞 Наш номер для связи: +79991234567

🔥 Забронированы дополнительно:
- Чан: 2025‑07‑06 с 12:00 до 16:00
- Баня: 2025‑07‑06 с 12:00 до 16:00
```

---

## Технологии

* Go 1.24
* PostgreSQL
* Gorilla Mux
* Slog (собственный `zerolog`‑like handler)
* go-telegram/bot (интеграция с Telegram)
